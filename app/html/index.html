<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta charset="utf-8" />
        <meta name="keywords" content="更新,通知,ウェブプッシュ,プッシュ,WebPush,Push,RSS,ATOM" />
        <meta name="discription" content="気にサイトの更新をWebPush通知で受け取れるサービス" />
        <title>まとプ - 気になるサイトの更新をまとめてWebPush通知 -</title>
        <link rel="manifest" href="/manifest.json">
        <link rel="stylesheet" href="style/webpush.css" />
        <link rel="icon" type="image/x-icon" href="/img/hira_31.ico" />

        <link type="text/css" rel="stylesheet" href="//unpkg.com/bootstrap/dist/css/bootstrap.min.css"/>
        <link type="text/css" rel="stylesheet" href="//unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.css"/>

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/vue@2.5.15/dist/vue.js"></script>
        <script src="//unpkg.com/babel-polyfill@latest/dist/polyfill.min.js"></script>
        <script src="//unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.js"></script>
        <script src="js/main.js"></script>
    </head>

    <body>
        <div class="container">
            <h1>気になるサイトの更新をまとめてWebPush通知</h1>
            <div id="control">
                <button id="subscribe" class="btn-sm btn-primary" disabled></button>
                <button id="test" class="btn-sm btn-primary" disabled>通知をテストする</button>
            </div>

            <div id="how_to_use"><BR>
                <dl class="dl-horizontal">
                    <dt>対応ブラウザ</dt><dd>FireFox, Chrome</dd>
                    <dt>対応OS</dt><dd>Windows, Android, Mac</dd>
                    <dt>使い方</dt><dd>①プッシュ通知を有効にして、テスト通知が届くことを確認してください。</dd>
                    <dt></dt><dd>②下記の「登録済みサンプルサイト」のリストから更新を通知してほしいサイトをチェックしてください。</dd>
                    <dt></dt><dd>③「登録済みサンプルサイト」のリストにないサイトはサイトURLを参考にフィード配信しているURLを入力することで追加ができます。</dd>
                    <dt></dt><dd>→RSS 1.0, RSS 2.0, ATOMに対応しています。(html内にフィードへのリンクがあればhtmlを指定してもいいです)</dd>
                    <dt>通知について</dt><dd><strong>１時間に１回、サーバー側でサイトを巡回して新着記事があればWebPushで通知します。</strong></dd>
                </dl>
            </div>
            サイトURL(フィード配信URL)
            <div class="input-group">
                <div class="input-group-prepend">
                    <button id="addSite" class="btn btn-success" disabled>追加</button>
                </div>
                <input type="url" class="form-control" id="siteUrl" placeholder="http://any_site/feed.xml">
            </div>
            キーワード検索
            <div class="input-group">
                <div class="input-group-prepend">
                    <button id="searchSite" class="btn btn-success">検索</button>
                </div>
                <input type="text" class="form-control" id="keyword" placeholder="キーワード">
            </div>
            <br>
            <div id="search-list">
                <b-card-group columns>
                    <template v-for="(site, siteid) in items">
                        <b-card v-bind:header="site.title">
                            <p v-text="site.snippet"></p>
                        </b-card>
                    </template>
                </b-card-group>
            </div>
            <br>
            <div id="content-list">
                <template v-for="(site, siteid) in items">
                    <h6>
                        <template v-if="site.SiteIcon!=''">
                            <img v-bind:src="site.SiteIcon" style="width: 1.2rem; height: 1.2rem;"/>
                        </template>
                        <a v-bind:href="site.SiteUrl" target="_blank">{{site.SiteTitle}}</a>
                    </h6>
                    <div style="height: 200px;">
                    <b-carousel class="h-100" v-bind:id="site.FeedUrl"
                                style="text-shadow: 1px 1px 2px #333;"
                                background="rgb(76, 76, 76)"
                                :interval="0"
                                controls
                                indicators
                        >
                        <template v-for="(content, contentid) in site.Contents">
                            <b-carousel-slide
                                        style="height: 200px;"
                                        v-bind:id="content.Url"
                                        v-bind:img-src="content.ImageUrl"
                                        fluid-grow
                                        >
                                <div style="height: 130px; background-color: rgba(0, 0, 0, 0.3); color:white; display: flex;" 
                                            v-on:click="onclick(content.Url)">
                                    <div style="margin: auto; flex: 0 1 auto;">
                                        <h6 style="font-size: small;"
                                            v-text="content.Title" >
                                        </h6>
                                        <p style="max-height: 80px; line-height: 100%; font-size: x-small;"
                                            v-text="content.Summary">
                                        </p>
                                    </div>
                                </div>
                            </b-carousel-slide>
                        </template>
                    </b-carousel>
                    </div>
                    <br>
                </template>
            </div>            
            <h2>マイ・サイト</h2>
            現在通知対象、または過去に通知対象としてチェックしたことのあるサイトです。
            <table class="table">
                <thead>
                <tr class="d-flex">
                    <th class="col-1">通知</th>
                    <th class="col-5">サイト名</th>
                    <th class="col-6">最新記事</th>
                </tr>
                </thead>
                <tbody id="my-list">
                <tr class="d-flex" v-for="(item, index) in items">
                    <td class="col-1" v-on:click="item.Value=!item.Value; onclick(index)">
                        <input type="checkbox" v-model="item.Value">
                    </td>
                    <td class="col-5" v-on:click="item.Value=!item.Value; onclick(index)">{{item.SiteTitle}}
                        <span class="badge badge-pill badge-secondary">{{item.Type}}</span>
                    </td>
                    <td class="col-6"><a :href="item.ContentUrl">{{item.ContentTitle}}</a></td>
                </tr>
                </tbody>
            </table>

            <h2>登録済みサンプルサイト</h2>
            各行にある左端にあるチェックをつけることで、すぐに通知が行われるようになります。
            <table class="table">
                <thead>
                <tr class="d-flex">
                    <th class="col-1">通知</th>
                    <th class="col-5">サイト名</th>
                    <th class="col-6">最新記事</th>
                </tr>
                </thead>
                <tbody id="public-list">
                <tr class="d-flex" v-for="(item, index) in items">
                    <td class="col-1" v-on:click="item.Value=!item.Value; onclick(index)">
                        <input type="checkbox" v-model="item.Value">
                    </td>
                    <td class="col-5" v-on:click="item.Value=!item.Value; onclick(index)">{{item.SiteTitle}}
                        <span class="badge badge-pill badge-secondary">{{item.Type}}</span>
                    </td>
                    <td class="col-6"><a :href="item.ContentUrl">{{item.ContentTitle}}</a></td>
                </tr>
                </tbody>
            </table>
        </div>
    </body>
</html>